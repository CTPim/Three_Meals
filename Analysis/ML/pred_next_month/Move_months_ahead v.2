{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "efb2342f",
   "metadata": {},
   "source": [
    "## Purpose\n",
    "This notebook creates a new dataset where each row contains price data from its month and DJIA price movement data form the following month. For example, the row with the price of milk from May 2004 will contain the price movement of the DJIA for June 2004."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "8abdd5b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2368e4db",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date_time</th>\n",
       "      <th>Beef $/LB</th>\n",
       "      <th>Beef_Pct_Change (Monthly)</th>\n",
       "      <th>Price</th>\n",
       "      <th>Food - Index (1982-1984=100)</th>\n",
       "      <th>Food - Pct_Change (Yearly)</th>\n",
       "      <th>Food - Pct_Change (Monthly)</th>\n",
       "      <th>All Items - Index (1982-1984=100)</th>\n",
       "      <th>All Items - Pct_Change (Yearly)</th>\n",
       "      <th>All Items - Pct_Change (Monthly)</th>\n",
       "      <th>Milk Cost per Gallon</th>\n",
       "      <th>DJIA_change</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1995-07-01</td>\n",
       "      <td>1.365</td>\n",
       "      <td>2.400600</td>\n",
       "      <td>1.147</td>\n",
       "      <td>138.2</td>\n",
       "      <td>0.582242</td>\n",
       "      <td>0.290276</td>\n",
       "      <td>152.6</td>\n",
       "      <td>2.830189</td>\n",
       "      <td>0.131234</td>\n",
       "      <td>2.477</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1995-08-01</td>\n",
       "      <td>1.328</td>\n",
       "      <td>-2.710623</td>\n",
       "      <td>1.161</td>\n",
       "      <td>138.8</td>\n",
       "      <td>1.166181</td>\n",
       "      <td>0.434153</td>\n",
       "      <td>152.9</td>\n",
       "      <td>2.617450</td>\n",
       "      <td>0.196592</td>\n",
       "      <td>2.482</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1995-09-01</td>\n",
       "      <td>1.376</td>\n",
       "      <td>3.614458</td>\n",
       "      <td>1.159</td>\n",
       "      <td>139.5</td>\n",
       "      <td>1.528384</td>\n",
       "      <td>0.504323</td>\n",
       "      <td>153.1</td>\n",
       "      <td>2.545211</td>\n",
       "      <td>0.130804</td>\n",
       "      <td>2.459</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1995-10-01</td>\n",
       "      <td>1.371</td>\n",
       "      <td>-0.363372</td>\n",
       "      <td>1.175</td>\n",
       "      <td>140.6</td>\n",
       "      <td>2.852963</td>\n",
       "      <td>0.788530</td>\n",
       "      <td>153.5</td>\n",
       "      <td>2.744311</td>\n",
       "      <td>0.261267</td>\n",
       "      <td>2.473</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1995-11-01</td>\n",
       "      <td>1.368</td>\n",
       "      <td>-0.218818</td>\n",
       "      <td>1.169</td>\n",
       "      <td>141.0</td>\n",
       "      <td>3.296703</td>\n",
       "      <td>0.284495</td>\n",
       "      <td>153.7</td>\n",
       "      <td>2.603471</td>\n",
       "      <td>0.130293</td>\n",
       "      <td>2.493</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    date_time  Beef $/LB  Beef_Pct_Change (Monthly)  Price  \\\n",
       "0  1995-07-01      1.365                   2.400600  1.147   \n",
       "1  1995-08-01      1.328                  -2.710623  1.161   \n",
       "2  1995-09-01      1.376                   3.614458  1.159   \n",
       "3  1995-10-01      1.371                  -0.363372  1.175   \n",
       "4  1995-11-01      1.368                  -0.218818  1.169   \n",
       "\n",
       "   Food - Index (1982-1984=100)  Food - Pct_Change (Yearly)  \\\n",
       "0                         138.2                    0.582242   \n",
       "1                         138.8                    1.166181   \n",
       "2                         139.5                    1.528384   \n",
       "3                         140.6                    2.852963   \n",
       "4                         141.0                    3.296703   \n",
       "\n",
       "   Food - Pct_Change (Monthly)  All Items - Index (1982-1984=100)  \\\n",
       "0                     0.290276                              152.6   \n",
       "1                     0.434153                              152.9   \n",
       "2                     0.504323                              153.1   \n",
       "3                     0.788530                              153.5   \n",
       "4                     0.284495                              153.7   \n",
       "\n",
       "   All Items - Pct_Change (Yearly)  All Items - Pct_Change (Monthly)  \\\n",
       "0                         2.830189                          0.131234   \n",
       "1                         2.617450                          0.196592   \n",
       "2                         2.545211                          0.130804   \n",
       "3                         2.744311                          0.261267   \n",
       "4                         2.603471                          0.130293   \n",
       "\n",
       "   Milk Cost per Gallon  DJIA_change  \n",
       "0                 2.477            1  \n",
       "1                 2.482            0  \n",
       "2                 2.459            1  \n",
       "3                 2.473            0  \n",
       "4                 2.493            1  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "price_df = pd.read_csv(\"../same_date/ML2_data.csv\")\n",
    "price_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "e46daa11",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beef $/LB</th>\n",
       "      <th>Beef_Pct_Change (Monthly)</th>\n",
       "      <th>Price</th>\n",
       "      <th>Food - Index (1982-1984=100)</th>\n",
       "      <th>Food - Pct_Change (Yearly)</th>\n",
       "      <th>Food - Pct_Change (Monthly)</th>\n",
       "      <th>All Items - Index (1982-1984=100)</th>\n",
       "      <th>All Items - Pct_Change (Yearly)</th>\n",
       "      <th>All Items - Pct_Change (Monthly)</th>\n",
       "      <th>Milk Cost per Gallon</th>\n",
       "      <th>DJIA_change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date_time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1995-07-01</th>\n",
       "      <td>1.365</td>\n",
       "      <td>2.400600</td>\n",
       "      <td>1.147</td>\n",
       "      <td>138.2</td>\n",
       "      <td>0.582242</td>\n",
       "      <td>0.290276</td>\n",
       "      <td>152.6</td>\n",
       "      <td>2.830189</td>\n",
       "      <td>0.131234</td>\n",
       "      <td>2.477</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-08-01</th>\n",
       "      <td>1.328</td>\n",
       "      <td>-2.710623</td>\n",
       "      <td>1.161</td>\n",
       "      <td>138.8</td>\n",
       "      <td>1.166181</td>\n",
       "      <td>0.434153</td>\n",
       "      <td>152.9</td>\n",
       "      <td>2.617450</td>\n",
       "      <td>0.196592</td>\n",
       "      <td>2.482</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-09-01</th>\n",
       "      <td>1.376</td>\n",
       "      <td>3.614458</td>\n",
       "      <td>1.159</td>\n",
       "      <td>139.5</td>\n",
       "      <td>1.528384</td>\n",
       "      <td>0.504323</td>\n",
       "      <td>153.1</td>\n",
       "      <td>2.545211</td>\n",
       "      <td>0.130804</td>\n",
       "      <td>2.459</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-10-01</th>\n",
       "      <td>1.371</td>\n",
       "      <td>-0.363372</td>\n",
       "      <td>1.175</td>\n",
       "      <td>140.6</td>\n",
       "      <td>2.852963</td>\n",
       "      <td>0.788530</td>\n",
       "      <td>153.5</td>\n",
       "      <td>2.744311</td>\n",
       "      <td>0.261267</td>\n",
       "      <td>2.473</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-11-01</th>\n",
       "      <td>1.368</td>\n",
       "      <td>-0.218818</td>\n",
       "      <td>1.169</td>\n",
       "      <td>141.0</td>\n",
       "      <td>3.296703</td>\n",
       "      <td>0.284495</td>\n",
       "      <td>153.7</td>\n",
       "      <td>2.603471</td>\n",
       "      <td>0.130293</td>\n",
       "      <td>2.493</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Beef $/LB  Beef_Pct_Change (Monthly)  Price  \\\n",
       "date_time                                                 \n",
       "1995-07-01      1.365                   2.400600  1.147   \n",
       "1995-08-01      1.328                  -2.710623  1.161   \n",
       "1995-09-01      1.376                   3.614458  1.159   \n",
       "1995-10-01      1.371                  -0.363372  1.175   \n",
       "1995-11-01      1.368                  -0.218818  1.169   \n",
       "\n",
       "            Food - Index (1982-1984=100)  Food - Pct_Change (Yearly)  \\\n",
       "date_time                                                              \n",
       "1995-07-01                         138.2                    0.582242   \n",
       "1995-08-01                         138.8                    1.166181   \n",
       "1995-09-01                         139.5                    1.528384   \n",
       "1995-10-01                         140.6                    2.852963   \n",
       "1995-11-01                         141.0                    3.296703   \n",
       "\n",
       "            Food - Pct_Change (Monthly)  All Items - Index (1982-1984=100)  \\\n",
       "date_time                                                                    \n",
       "1995-07-01                     0.290276                              152.6   \n",
       "1995-08-01                     0.434153                              152.9   \n",
       "1995-09-01                     0.504323                              153.1   \n",
       "1995-10-01                     0.788530                              153.5   \n",
       "1995-11-01                     0.284495                              153.7   \n",
       "\n",
       "            All Items - Pct_Change (Yearly)  All Items - Pct_Change (Monthly)  \\\n",
       "date_time                                                                       \n",
       "1995-07-01                         2.830189                          0.131234   \n",
       "1995-08-01                         2.617450                          0.196592   \n",
       "1995-09-01                         2.545211                          0.130804   \n",
       "1995-10-01                         2.744311                          0.261267   \n",
       "1995-11-01                         2.603471                          0.130293   \n",
       "\n",
       "            Milk Cost per Gallon  DJIA_change  \n",
       "date_time                                      \n",
       "1995-07-01                 2.477            1  \n",
       "1995-08-01                 2.482            0  \n",
       "1995-09-01                 2.459            1  \n",
       "1995-10-01                 2.473            0  \n",
       "1995-11-01                 2.493            1  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# set date_time as index\n",
    "price_df = price_df.set_index(\"date_time\")\n",
    "price_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ca3c6a64",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beef $/LB</th>\n",
       "      <th>Beef_Pct_Change (Monthly)</th>\n",
       "      <th>Price</th>\n",
       "      <th>Food - Index (1982-1984=100)</th>\n",
       "      <th>Food - Pct_Change (Yearly)</th>\n",
       "      <th>Food - Pct_Change (Monthly)</th>\n",
       "      <th>All Items - Index (1982-1984=100)</th>\n",
       "      <th>All Items - Pct_Change (Yearly)</th>\n",
       "      <th>All Items - Pct_Change (Monthly)</th>\n",
       "      <th>Milk Cost per Gallon</th>\n",
       "      <th>DJIA_change</th>\n",
       "      <th>Next_Month_DJIA_Change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date_time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1995-07-01</th>\n",
       "      <td>1.365</td>\n",
       "      <td>2.400600</td>\n",
       "      <td>1.147</td>\n",
       "      <td>138.2</td>\n",
       "      <td>0.582242</td>\n",
       "      <td>0.290276</td>\n",
       "      <td>152.6</td>\n",
       "      <td>2.830189</td>\n",
       "      <td>0.131234</td>\n",
       "      <td>2.477</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-08-01</th>\n",
       "      <td>1.328</td>\n",
       "      <td>-2.710623</td>\n",
       "      <td>1.161</td>\n",
       "      <td>138.8</td>\n",
       "      <td>1.166181</td>\n",
       "      <td>0.434153</td>\n",
       "      <td>152.9</td>\n",
       "      <td>2.617450</td>\n",
       "      <td>0.196592</td>\n",
       "      <td>2.482</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-09-01</th>\n",
       "      <td>1.376</td>\n",
       "      <td>3.614458</td>\n",
       "      <td>1.159</td>\n",
       "      <td>139.5</td>\n",
       "      <td>1.528384</td>\n",
       "      <td>0.504323</td>\n",
       "      <td>153.1</td>\n",
       "      <td>2.545211</td>\n",
       "      <td>0.130804</td>\n",
       "      <td>2.459</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-10-01</th>\n",
       "      <td>1.371</td>\n",
       "      <td>-0.363372</td>\n",
       "      <td>1.175</td>\n",
       "      <td>140.6</td>\n",
       "      <td>2.852963</td>\n",
       "      <td>0.788530</td>\n",
       "      <td>153.5</td>\n",
       "      <td>2.744311</td>\n",
       "      <td>0.261267</td>\n",
       "      <td>2.473</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-11-01</th>\n",
       "      <td>1.368</td>\n",
       "      <td>-0.218818</td>\n",
       "      <td>1.169</td>\n",
       "      <td>141.0</td>\n",
       "      <td>3.296703</td>\n",
       "      <td>0.284495</td>\n",
       "      <td>153.7</td>\n",
       "      <td>2.603471</td>\n",
       "      <td>0.130293</td>\n",
       "      <td>2.493</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Beef $/LB  Beef_Pct_Change (Monthly)  Price  \\\n",
       "date_time                                                 \n",
       "1995-07-01      1.365                   2.400600  1.147   \n",
       "1995-08-01      1.328                  -2.710623  1.161   \n",
       "1995-09-01      1.376                   3.614458  1.159   \n",
       "1995-10-01      1.371                  -0.363372  1.175   \n",
       "1995-11-01      1.368                  -0.218818  1.169   \n",
       "\n",
       "            Food - Index (1982-1984=100)  Food - Pct_Change (Yearly)  \\\n",
       "date_time                                                              \n",
       "1995-07-01                         138.2                    0.582242   \n",
       "1995-08-01                         138.8                    1.166181   \n",
       "1995-09-01                         139.5                    1.528384   \n",
       "1995-10-01                         140.6                    2.852963   \n",
       "1995-11-01                         141.0                    3.296703   \n",
       "\n",
       "            Food - Pct_Change (Monthly)  All Items - Index (1982-1984=100)  \\\n",
       "date_time                                                                    \n",
       "1995-07-01                     0.290276                              152.6   \n",
       "1995-08-01                     0.434153                              152.9   \n",
       "1995-09-01                     0.504323                              153.1   \n",
       "1995-10-01                     0.788530                              153.5   \n",
       "1995-11-01                     0.284495                              153.7   \n",
       "\n",
       "            All Items - Pct_Change (Yearly)  All Items - Pct_Change (Monthly)  \\\n",
       "date_time                                                                       \n",
       "1995-07-01                         2.830189                          0.131234   \n",
       "1995-08-01                         2.617450                          0.196592   \n",
       "1995-09-01                         2.545211                          0.130804   \n",
       "1995-10-01                         2.744311                          0.261267   \n",
       "1995-11-01                         2.603471                          0.130293   \n",
       "\n",
       "            Milk Cost per Gallon  DJIA_change Next_Month_DJIA_Change  \n",
       "date_time                                                             \n",
       "1995-07-01                 2.477            1                      0  \n",
       "1995-08-01                 2.482            0                      1  \n",
       "1995-09-01                 2.459            1                      0  \n",
       "1995-10-01                 2.473            0                      1  \n",
       "1995-11-01                 2.493            1                      1  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Move all the DJIA data up one month\n",
    "\n",
    "# Save values as list\n",
    "djia_list = list(price_df[\"DJIA_change\"].values)\n",
    "\n",
    "# Create new list\n",
    "new_djia = []\n",
    "\n",
    "# Use for loop to make each list index equivalent to the one after it\n",
    "for i in range(1, len(djia_list)):\n",
    "    new_djia.append(djia_list[i])\n",
    "\n",
    "# We do not have data for the month following the last month in the dataset\n",
    "# So we will insert this placeholder and drop the row later\n",
    "new_djia.append(\"NA\")\n",
    "\n",
    "price_df[\"Next_Month_DJIA_Change\"] = new_djia\n",
    "\n",
    "price_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d48db001",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beef $/LB</th>\n",
       "      <th>Beef_Pct_Change (Monthly)</th>\n",
       "      <th>Price</th>\n",
       "      <th>Food - Index (1982-1984=100)</th>\n",
       "      <th>Food - Pct_Change (Yearly)</th>\n",
       "      <th>Food - Pct_Change (Monthly)</th>\n",
       "      <th>All Items - Index (1982-1984=100)</th>\n",
       "      <th>All Items - Pct_Change (Yearly)</th>\n",
       "      <th>All Items - Pct_Change (Monthly)</th>\n",
       "      <th>Milk Cost per Gallon</th>\n",
       "      <th>DJIA_change</th>\n",
       "      <th>Next_Month_DJIA_Change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date_time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2022-04-01</th>\n",
       "      <td>4.916</td>\n",
       "      <td>3.342443</td>\n",
       "      <td>2.145</td>\n",
       "      <td>310.280</td>\n",
       "      <td>14.350577</td>\n",
       "      <td>1.134619</td>\n",
       "      <td>288.611</td>\n",
       "      <td>8.227772</td>\n",
       "      <td>0.396213</td>\n",
       "      <td>4.012</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-05-01</th>\n",
       "      <td>4.794</td>\n",
       "      <td>-2.481692</td>\n",
       "      <td>2.220</td>\n",
       "      <td>313.944</td>\n",
       "      <td>14.207137</td>\n",
       "      <td>1.180869</td>\n",
       "      <td>291.268</td>\n",
       "      <td>8.502332</td>\n",
       "      <td>0.920616</td>\n",
       "      <td>4.204</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-06-01</th>\n",
       "      <td>4.889</td>\n",
       "      <td>1.981644</td>\n",
       "      <td>2.230</td>\n",
       "      <td>314.138</td>\n",
       "      <td>11.696291</td>\n",
       "      <td>0.061794</td>\n",
       "      <td>294.728</td>\n",
       "      <td>8.932987</td>\n",
       "      <td>1.187909</td>\n",
       "      <td>4.153</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-07-01</th>\n",
       "      <td>4.893</td>\n",
       "      <td>0.081816</td>\n",
       "      <td>2.316</td>\n",
       "      <td>315.797</td>\n",
       "      <td>10.876770</td>\n",
       "      <td>0.528112</td>\n",
       "      <td>294.628</td>\n",
       "      <td>8.413182</td>\n",
       "      <td>-0.033930</td>\n",
       "      <td>4.156</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-08-01</th>\n",
       "      <td>4.937</td>\n",
       "      <td>0.899244</td>\n",
       "      <td>2.298</td>\n",
       "      <td>317.433</td>\n",
       "      <td>10.640456</td>\n",
       "      <td>0.518054</td>\n",
       "      <td>295.320</td>\n",
       "      <td>8.227361</td>\n",
       "      <td>0.234872</td>\n",
       "      <td>4.194</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-09-01</th>\n",
       "      <td>4.862</td>\n",
       "      <td>-1.519141</td>\n",
       "      <td>2.362</td>\n",
       "      <td>318.374</td>\n",
       "      <td>8.964276</td>\n",
       "      <td>0.296441</td>\n",
       "      <td>296.539</td>\n",
       "      <td>8.214854</td>\n",
       "      <td>0.412773</td>\n",
       "      <td>4.181</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-10-01</th>\n",
       "      <td>4.836</td>\n",
       "      <td>-0.534759</td>\n",
       "      <td>2.386</td>\n",
       "      <td>319.917</td>\n",
       "      <td>8.002714</td>\n",
       "      <td>0.484650</td>\n",
       "      <td>297.987</td>\n",
       "      <td>7.762493</td>\n",
       "      <td>0.488300</td>\n",
       "      <td>4.184</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-11-01</th>\n",
       "      <td>4.853</td>\n",
       "      <td>0.351530</td>\n",
       "      <td>2.419</td>\n",
       "      <td>320.034</td>\n",
       "      <td>6.721044</td>\n",
       "      <td>0.036572</td>\n",
       "      <td>298.598</td>\n",
       "      <td>7.135348</td>\n",
       "      <td>0.205043</td>\n",
       "      <td>4.218</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-12-01</th>\n",
       "      <td>4.800</td>\n",
       "      <td>-1.092108</td>\n",
       "      <td>2.419</td>\n",
       "      <td>322.507</td>\n",
       "      <td>7.644424</td>\n",
       "      <td>0.772730</td>\n",
       "      <td>298.990</td>\n",
       "      <td>6.444940</td>\n",
       "      <td>0.131280</td>\n",
       "      <td>4.211</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023-01-01</th>\n",
       "      <td>4.791</td>\n",
       "      <td>-0.187500</td>\n",
       "      <td>2.451</td>\n",
       "      <td>324.815</td>\n",
       "      <td>8.047648</td>\n",
       "      <td>0.715643</td>\n",
       "      <td>300.536</td>\n",
       "      <td>6.347156</td>\n",
       "      <td>0.517074</td>\n",
       "      <td>4.204</td>\n",
       "      <td>1</td>\n",
       "      <td>NA</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Beef $/LB  Beef_Pct_Change (Monthly)  Price  \\\n",
       "date_time                                                 \n",
       "2022-04-01      4.916                   3.342443  2.145   \n",
       "2022-05-01      4.794                  -2.481692  2.220   \n",
       "2022-06-01      4.889                   1.981644  2.230   \n",
       "2022-07-01      4.893                   0.081816  2.316   \n",
       "2022-08-01      4.937                   0.899244  2.298   \n",
       "2022-09-01      4.862                  -1.519141  2.362   \n",
       "2022-10-01      4.836                  -0.534759  2.386   \n",
       "2022-11-01      4.853                   0.351530  2.419   \n",
       "2022-12-01      4.800                  -1.092108  2.419   \n",
       "2023-01-01      4.791                  -0.187500  2.451   \n",
       "\n",
       "            Food - Index (1982-1984=100)  Food - Pct_Change (Yearly)  \\\n",
       "date_time                                                              \n",
       "2022-04-01                       310.280                   14.350577   \n",
       "2022-05-01                       313.944                   14.207137   \n",
       "2022-06-01                       314.138                   11.696291   \n",
       "2022-07-01                       315.797                   10.876770   \n",
       "2022-08-01                       317.433                   10.640456   \n",
       "2022-09-01                       318.374                    8.964276   \n",
       "2022-10-01                       319.917                    8.002714   \n",
       "2022-11-01                       320.034                    6.721044   \n",
       "2022-12-01                       322.507                    7.644424   \n",
       "2023-01-01                       324.815                    8.047648   \n",
       "\n",
       "            Food - Pct_Change (Monthly)  All Items - Index (1982-1984=100)  \\\n",
       "date_time                                                                    \n",
       "2022-04-01                     1.134619                            288.611   \n",
       "2022-05-01                     1.180869                            291.268   \n",
       "2022-06-01                     0.061794                            294.728   \n",
       "2022-07-01                     0.528112                            294.628   \n",
       "2022-08-01                     0.518054                            295.320   \n",
       "2022-09-01                     0.296441                            296.539   \n",
       "2022-10-01                     0.484650                            297.987   \n",
       "2022-11-01                     0.036572                            298.598   \n",
       "2022-12-01                     0.772730                            298.990   \n",
       "2023-01-01                     0.715643                            300.536   \n",
       "\n",
       "            All Items - Pct_Change (Yearly)  All Items - Pct_Change (Monthly)  \\\n",
       "date_time                                                                       \n",
       "2022-04-01                         8.227772                          0.396213   \n",
       "2022-05-01                         8.502332                          0.920616   \n",
       "2022-06-01                         8.932987                          1.187909   \n",
       "2022-07-01                         8.413182                         -0.033930   \n",
       "2022-08-01                         8.227361                          0.234872   \n",
       "2022-09-01                         8.214854                          0.412773   \n",
       "2022-10-01                         7.762493                          0.488300   \n",
       "2022-11-01                         7.135348                          0.205043   \n",
       "2022-12-01                         6.444940                          0.131280   \n",
       "2023-01-01                         6.347156                          0.517074   \n",
       "\n",
       "            Milk Cost per Gallon  DJIA_change Next_Month_DJIA_Change  \n",
       "date_time                                                             \n",
       "2022-04-01                 4.012            0                      1  \n",
       "2022-05-01                 4.204            1                      0  \n",
       "2022-06-01                 4.153            0                      1  \n",
       "2022-07-01                 4.156            1                      0  \n",
       "2022-08-01                 4.194            0                      0  \n",
       "2022-09-01                 4.181            0                      1  \n",
       "2022-10-01                 4.184            1                      1  \n",
       "2022-11-01                 4.218            1                      0  \n",
       "2022-12-01                 4.211            0                      1  \n",
       "2023-01-01                 4.204            1                     NA  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check tail\n",
    "price_df.tail(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "89865429",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beef $/LB</th>\n",
       "      <th>Beef_Pct_Change (Monthly)</th>\n",
       "      <th>Price</th>\n",
       "      <th>Food - Index (1982-1984=100)</th>\n",
       "      <th>Food - Pct_Change (Yearly)</th>\n",
       "      <th>Food - Pct_Change (Monthly)</th>\n",
       "      <th>All Items - Index (1982-1984=100)</th>\n",
       "      <th>All Items - Pct_Change (Yearly)</th>\n",
       "      <th>All Items - Pct_Change (Monthly)</th>\n",
       "      <th>Milk Cost per Gallon</th>\n",
       "      <th>DJIA_change</th>\n",
       "      <th>Next_Month_DJIA_Change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date_time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2022-03-01</th>\n",
       "      <td>4.757</td>\n",
       "      <td>2.742981</td>\n",
       "      <td>2.121</td>\n",
       "      <td>306.799</td>\n",
       "      <td>13.732461</td>\n",
       "      <td>0.911097</td>\n",
       "      <td>287.472</td>\n",
       "      <td>8.515216</td>\n",
       "      <td>1.005587</td>\n",
       "      <td>3.917</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-04-01</th>\n",
       "      <td>4.916</td>\n",
       "      <td>3.342443</td>\n",
       "      <td>2.145</td>\n",
       "      <td>310.280</td>\n",
       "      <td>14.350577</td>\n",
       "      <td>1.134619</td>\n",
       "      <td>288.611</td>\n",
       "      <td>8.227772</td>\n",
       "      <td>0.396213</td>\n",
       "      <td>4.012</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-05-01</th>\n",
       "      <td>4.794</td>\n",
       "      <td>-2.481692</td>\n",
       "      <td>2.220</td>\n",
       "      <td>313.944</td>\n",
       "      <td>14.207137</td>\n",
       "      <td>1.180869</td>\n",
       "      <td>291.268</td>\n",
       "      <td>8.502332</td>\n",
       "      <td>0.920616</td>\n",
       "      <td>4.204</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-06-01</th>\n",
       "      <td>4.889</td>\n",
       "      <td>1.981644</td>\n",
       "      <td>2.230</td>\n",
       "      <td>314.138</td>\n",
       "      <td>11.696291</td>\n",
       "      <td>0.061794</td>\n",
       "      <td>294.728</td>\n",
       "      <td>8.932987</td>\n",
       "      <td>1.187909</td>\n",
       "      <td>4.153</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-07-01</th>\n",
       "      <td>4.893</td>\n",
       "      <td>0.081816</td>\n",
       "      <td>2.316</td>\n",
       "      <td>315.797</td>\n",
       "      <td>10.876770</td>\n",
       "      <td>0.528112</td>\n",
       "      <td>294.628</td>\n",
       "      <td>8.413182</td>\n",
       "      <td>-0.033930</td>\n",
       "      <td>4.156</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-08-01</th>\n",
       "      <td>4.937</td>\n",
       "      <td>0.899244</td>\n",
       "      <td>2.298</td>\n",
       "      <td>317.433</td>\n",
       "      <td>10.640456</td>\n",
       "      <td>0.518054</td>\n",
       "      <td>295.320</td>\n",
       "      <td>8.227361</td>\n",
       "      <td>0.234872</td>\n",
       "      <td>4.194</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-09-01</th>\n",
       "      <td>4.862</td>\n",
       "      <td>-1.519141</td>\n",
       "      <td>2.362</td>\n",
       "      <td>318.374</td>\n",
       "      <td>8.964276</td>\n",
       "      <td>0.296441</td>\n",
       "      <td>296.539</td>\n",
       "      <td>8.214854</td>\n",
       "      <td>0.412773</td>\n",
       "      <td>4.181</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-10-01</th>\n",
       "      <td>4.836</td>\n",
       "      <td>-0.534759</td>\n",
       "      <td>2.386</td>\n",
       "      <td>319.917</td>\n",
       "      <td>8.002714</td>\n",
       "      <td>0.484650</td>\n",
       "      <td>297.987</td>\n",
       "      <td>7.762493</td>\n",
       "      <td>0.488300</td>\n",
       "      <td>4.184</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-11-01</th>\n",
       "      <td>4.853</td>\n",
       "      <td>0.351530</td>\n",
       "      <td>2.419</td>\n",
       "      <td>320.034</td>\n",
       "      <td>6.721044</td>\n",
       "      <td>0.036572</td>\n",
       "      <td>298.598</td>\n",
       "      <td>7.135348</td>\n",
       "      <td>0.205043</td>\n",
       "      <td>4.218</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022-12-01</th>\n",
       "      <td>4.800</td>\n",
       "      <td>-1.092108</td>\n",
       "      <td>2.419</td>\n",
       "      <td>322.507</td>\n",
       "      <td>7.644424</td>\n",
       "      <td>0.772730</td>\n",
       "      <td>298.990</td>\n",
       "      <td>6.444940</td>\n",
       "      <td>0.131280</td>\n",
       "      <td>4.211</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Beef $/LB  Beef_Pct_Change (Monthly)  Price  \\\n",
       "date_time                                                 \n",
       "2022-03-01      4.757                   2.742981  2.121   \n",
       "2022-04-01      4.916                   3.342443  2.145   \n",
       "2022-05-01      4.794                  -2.481692  2.220   \n",
       "2022-06-01      4.889                   1.981644  2.230   \n",
       "2022-07-01      4.893                   0.081816  2.316   \n",
       "2022-08-01      4.937                   0.899244  2.298   \n",
       "2022-09-01      4.862                  -1.519141  2.362   \n",
       "2022-10-01      4.836                  -0.534759  2.386   \n",
       "2022-11-01      4.853                   0.351530  2.419   \n",
       "2022-12-01      4.800                  -1.092108  2.419   \n",
       "\n",
       "            Food - Index (1982-1984=100)  Food - Pct_Change (Yearly)  \\\n",
       "date_time                                                              \n",
       "2022-03-01                       306.799                   13.732461   \n",
       "2022-04-01                       310.280                   14.350577   \n",
       "2022-05-01                       313.944                   14.207137   \n",
       "2022-06-01                       314.138                   11.696291   \n",
       "2022-07-01                       315.797                   10.876770   \n",
       "2022-08-01                       317.433                   10.640456   \n",
       "2022-09-01                       318.374                    8.964276   \n",
       "2022-10-01                       319.917                    8.002714   \n",
       "2022-11-01                       320.034                    6.721044   \n",
       "2022-12-01                       322.507                    7.644424   \n",
       "\n",
       "            Food - Pct_Change (Monthly)  All Items - Index (1982-1984=100)  \\\n",
       "date_time                                                                    \n",
       "2022-03-01                     0.911097                            287.472   \n",
       "2022-04-01                     1.134619                            288.611   \n",
       "2022-05-01                     1.180869                            291.268   \n",
       "2022-06-01                     0.061794                            294.728   \n",
       "2022-07-01                     0.528112                            294.628   \n",
       "2022-08-01                     0.518054                            295.320   \n",
       "2022-09-01                     0.296441                            296.539   \n",
       "2022-10-01                     0.484650                            297.987   \n",
       "2022-11-01                     0.036572                            298.598   \n",
       "2022-12-01                     0.772730                            298.990   \n",
       "\n",
       "            All Items - Pct_Change (Yearly)  All Items - Pct_Change (Monthly)  \\\n",
       "date_time                                                                       \n",
       "2022-03-01                         8.515216                          1.005587   \n",
       "2022-04-01                         8.227772                          0.396213   \n",
       "2022-05-01                         8.502332                          0.920616   \n",
       "2022-06-01                         8.932987                          1.187909   \n",
       "2022-07-01                         8.413182                         -0.033930   \n",
       "2022-08-01                         8.227361                          0.234872   \n",
       "2022-09-01                         8.214854                          0.412773   \n",
       "2022-10-01                         7.762493                          0.488300   \n",
       "2022-11-01                         7.135348                          0.205043   \n",
       "2022-12-01                         6.444940                          0.131280   \n",
       "\n",
       "            Milk Cost per Gallon  DJIA_change Next_Month_DJIA_Change  \n",
       "date_time                                                             \n",
       "2022-03-01                 3.917            1                      0  \n",
       "2022-04-01                 4.012            0                      1  \n",
       "2022-05-01                 4.204            1                      0  \n",
       "2022-06-01                 4.153            0                      1  \n",
       "2022-07-01                 4.156            1                      0  \n",
       "2022-08-01                 4.194            0                      0  \n",
       "2022-09-01                 4.181            0                      1  \n",
       "2022-10-01                 4.184            1                      1  \n",
       "2022-11-01                 4.218            1                      0  \n",
       "2022-12-01                 4.211            0                      1  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Drop last row because we don't have data on the future\n",
    "price_df = price_df.drop(\"2023-01-01\", axis=0)\n",
    "price_df.tail(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f73695a6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beef $/LB</th>\n",
       "      <th>Beef_Pct_Change (Monthly)</th>\n",
       "      <th>Price</th>\n",
       "      <th>Food - Index (1982-1984=100)</th>\n",
       "      <th>Food - Pct_Change (Yearly)</th>\n",
       "      <th>Food - Pct_Change (Monthly)</th>\n",
       "      <th>All Items - Index (1982-1984=100)</th>\n",
       "      <th>All Items - Pct_Change (Yearly)</th>\n",
       "      <th>All Items - Pct_Change (Monthly)</th>\n",
       "      <th>Milk Cost per Gallon</th>\n",
       "      <th>Next_Month_DJIA_Change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date_time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1995-07-01</th>\n",
       "      <td>1.365</td>\n",
       "      <td>2.400600</td>\n",
       "      <td>1.147</td>\n",
       "      <td>138.2</td>\n",
       "      <td>0.582242</td>\n",
       "      <td>0.290276</td>\n",
       "      <td>152.6</td>\n",
       "      <td>2.830189</td>\n",
       "      <td>0.131234</td>\n",
       "      <td>2.477</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-08-01</th>\n",
       "      <td>1.328</td>\n",
       "      <td>-2.710623</td>\n",
       "      <td>1.161</td>\n",
       "      <td>138.8</td>\n",
       "      <td>1.166181</td>\n",
       "      <td>0.434153</td>\n",
       "      <td>152.9</td>\n",
       "      <td>2.617450</td>\n",
       "      <td>0.196592</td>\n",
       "      <td>2.482</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-09-01</th>\n",
       "      <td>1.376</td>\n",
       "      <td>3.614458</td>\n",
       "      <td>1.159</td>\n",
       "      <td>139.5</td>\n",
       "      <td>1.528384</td>\n",
       "      <td>0.504323</td>\n",
       "      <td>153.1</td>\n",
       "      <td>2.545211</td>\n",
       "      <td>0.130804</td>\n",
       "      <td>2.459</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-10-01</th>\n",
       "      <td>1.371</td>\n",
       "      <td>-0.363372</td>\n",
       "      <td>1.175</td>\n",
       "      <td>140.6</td>\n",
       "      <td>2.852963</td>\n",
       "      <td>0.788530</td>\n",
       "      <td>153.5</td>\n",
       "      <td>2.744311</td>\n",
       "      <td>0.261267</td>\n",
       "      <td>2.473</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1995-11-01</th>\n",
       "      <td>1.368</td>\n",
       "      <td>-0.218818</td>\n",
       "      <td>1.169</td>\n",
       "      <td>141.0</td>\n",
       "      <td>3.296703</td>\n",
       "      <td>0.284495</td>\n",
       "      <td>153.7</td>\n",
       "      <td>2.603471</td>\n",
       "      <td>0.130293</td>\n",
       "      <td>2.493</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Beef $/LB  Beef_Pct_Change (Monthly)  Price  \\\n",
       "date_time                                                 \n",
       "1995-07-01      1.365                   2.400600  1.147   \n",
       "1995-08-01      1.328                  -2.710623  1.161   \n",
       "1995-09-01      1.376                   3.614458  1.159   \n",
       "1995-10-01      1.371                  -0.363372  1.175   \n",
       "1995-11-01      1.368                  -0.218818  1.169   \n",
       "\n",
       "            Food - Index (1982-1984=100)  Food - Pct_Change (Yearly)  \\\n",
       "date_time                                                              \n",
       "1995-07-01                         138.2                    0.582242   \n",
       "1995-08-01                         138.8                    1.166181   \n",
       "1995-09-01                         139.5                    1.528384   \n",
       "1995-10-01                         140.6                    2.852963   \n",
       "1995-11-01                         141.0                    3.296703   \n",
       "\n",
       "            Food - Pct_Change (Monthly)  All Items - Index (1982-1984=100)  \\\n",
       "date_time                                                                    \n",
       "1995-07-01                     0.290276                              152.6   \n",
       "1995-08-01                     0.434153                              152.9   \n",
       "1995-09-01                     0.504323                              153.1   \n",
       "1995-10-01                     0.788530                              153.5   \n",
       "1995-11-01                     0.284495                              153.7   \n",
       "\n",
       "            All Items - Pct_Change (Yearly)  All Items - Pct_Change (Monthly)  \\\n",
       "date_time                                                                       \n",
       "1995-07-01                         2.830189                          0.131234   \n",
       "1995-08-01                         2.617450                          0.196592   \n",
       "1995-09-01                         2.545211                          0.130804   \n",
       "1995-10-01                         2.744311                          0.261267   \n",
       "1995-11-01                         2.603471                          0.130293   \n",
       "\n",
       "            Milk Cost per Gallon Next_Month_DJIA_Change  \n",
       "date_time                                                \n",
       "1995-07-01                 2.477                      0  \n",
       "1995-08-01                 2.482                      1  \n",
       "1995-09-01                 2.459                      0  \n",
       "1995-10-01                 2.473                      1  \n",
       "1995-11-01                 2.493                      1  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Drop unneeded DJIA_change column\n",
    "next_month_df = price_df.drop(\"DJIA_change\", axis=1)\n",
    "next_month_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "86b3417c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save this data as new CSV file\n",
    "output_path = \"ML2_pred_data.csv\"\n",
    "next_month_df.to_csv(output_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "17bd727f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "mnlev",
   "language": "python",
   "name": "mnlev"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
